
--------
## 最大流-最小カット定理

最大s-tフローの流量 = 最小s-tカットの容量

グラフGの最小カットの辺集合は最大流が求まった後の残余グラフにおいてsから到達可能な頂点の集合から出て行く辺の集合

--------

## 用語

* マッチング: 辺集合 M ⊆ E で、端点を共有しない 
* 辺カバー: 辺集合 F ⊆ E で、Gのどの頂点も少なくとも1つのFに含まれる辺に接続している 
* 安定集合: 点集合 S ⊆ V で、Sのどの2点もGにおいて隣接していない （独立集合とも呼ばれる）
* 点カバー: 点集合 S ⊆ V で、Sのどの辺も少なくとも1つのSに含まれる点に接続している

孤立点の無いグラフで |最大マッチング| + |最小辺カバー| = |V|

一般のグラフで |最大安定集合| + |最小点カバー| = |V|

X ⊆ V が G の安定集合⇔ X\V が G の点カバー

--------

## 二部グラフ

二部グラフ ⇔ 奇数長閉路が存在しない

二部グラフの|最大マッチング| = 向き付けして始点終点を追加したグラフでの|最大流|

二部グラフの|最小辺カバー| = |最大安定集合|

二部グラフの|最大マッチング| = |最小点カバー| (一般のグラフでは≧)

--------

## DAGでの最小パスカバー

一般には解けないが、閉路が無いときは最大流（というか重みなし二部マッチング）で解ける。

グラフの頂点が1..Nとする。頂点がx1..xN, y1..yNで、元グラフにi->jの辺があればxi->yjに辺を張る二部グラフでマッチングを行う。 始めは全頂点が独立であるとすれば、経路数はNである。 マッチングにおいて選ばれた辺xi->yjは頂点iとjが同一の経路にまとめられることに対応する。 したがって最小経路数はNからマッチングの値を引くと求まる。 閉路がある場合はうまくいかない。 

## Hall（ホール）の結婚定理

二部グラフ G=(X+Y,E)に対して、以下が成り立つ
（ただしΓ(T)は頂点集合Tに隣接する頂点の集合）

    Xの頂点を全てカバーするマッチングが存在する
    ⇔
    Xの任意の部分集合Tについて|T|<=|Γ(T)|

### 例題

* ARC076 F. Exhausted?

--------

## Dilworthの定理

推移的に得られる辺を付け加えた DAG（つまり i → j, j → k の辺がある時、必ず i → k の辺もあるような DAG ）に対し、以下が成り立つ

(最小パス被覆の本数) = (任意の 2 点間に辺が存在しないような頂点集合の最大サイズ)

* 「任意の 2 点間に辺が存在しないような頂点集合」は antichain と呼ばれる。安定集合。独立点集合。
* 推移的に得られる辺を付け加えた DAG とは、半順序集合の別の言い方のことです。

### 例題

* JOI2015/2016 春季トレーニング合宿 Day1 マトリョーシカ人形

--------

## Mirskyの定理

推移的に得られる辺を付け加えた DAG（つまり i → j, j → k の辺がある時、必ず i → k の辺もあるような DAG ）に対し、以下が成り立つ

最長パスの長さ = グラフを任意の 2 点間に辺が存在しないような頂点集合へ分割する最小分割数

* Dilworthの定理の双対
    * chainの最大サイズ = antichainへの最小分割数 (Mirskyの定理) 
    * antichainの最大サイズ = chainへの最小分割数 (Dilworthの定理) 

--------

## Project Selection Problem

N 個の要素がある。
最初どの頂点も集合 B に属しているが、これを集合 A に移すことで利益を最大化したい。
要素 i が A に属する時には利得 p_i を得るという情報が与えられる。
さらに 3 つ組の列 (xj, yj, zj) が与えられ、これは xj が A に属し、かつ yj が B に属していた時に zj(≥ 0) だけ損失をすることを意味する。
得られる利得の最大値を答えよ。

この問題に対する解は (∑(v∈V) max(0, pv) ) − maxflow(s, t)で求めることができる。
ただし、 maxflow(s, t) とは、

1. 要素に対応する点の他に，新しく s, t の頂点を導入した N + 2 頂点のグラフの上に、
2. pv > 0 であれば s から v に容量 pv の辺を張り、
3. pv < 0 であれば v から t に容量 −pv の辺を張り、
4. xj から yj に容量 zj の辺を張ったときの、
5. s-t 間の最大流の値

--------
